// prisma/schema.prisma

generator client {
  provider = "prisma-client-js"
}

enum ApplicationStage {
  APPLIED
  SCREENING
  HM_INTERVIEW
  PANEL
  OFFER
  HIRED
  REJECTED
}

datasource db {
  provider  = "postgresql"
  url       = env("DATABASE_URL")  // pooled
  directUrl = env("DIRECT_URL")    // direct
}

model ClientCompany {
  id          String   @id @default(cuid())
  name        String
  slug        String   @unique
  logoUrl     String?
  website     String?
  description String?

  jobs        Job[]

  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt
}

model Job {
  id             String   @id @default(cuid())
  client         ClientCompany? @relation(fields: [clientId], references: [id])
  clientId       String?
  title          String
  slug           String   @unique
  location       String?
  jobType        String?   // full-time, contract, internship
  level          String?   // graduate, mid, senior, executive
  function       String?   // e.g. Product, HR, Finance
  industry       String?   // e.g. Fintech, Banking
  summary        String?
  description    String?
  requirements   String?
  salaryCurrency String?
  salaryMin      Int?
  salaryMax      Int?
  remoteOption   String?   // remote, hybrid, onsite
  status         String    @default("open") // open, on_hold, closed

  applications   Application[]

  createdAt      DateTime  @default(now())
  updatedAt      DateTime  @updatedAt
}

model Candidate {
  id                    String   @id @default(cuid())
  fullName              String
  email                 String   @unique
  phone                 String?
  city                  String?
  country               String?
  headline              String?
  summary               String?
  currentRole           String?
  currentCompany        String?
  totalExperienceYears  Int?

  level                 String?  // graduate, mid, senior, executive
  functions             String?  // comma-separated list
  industries            String?  // comma-separated list
  skills                String?  // comma-separated list

  preferredLocations    String?  // comma-separated; e.g. "Nigeria,Ghana,Remote"
  workPreference        String?  // remote, onsite, hybrid
  salaryCurrency        String?
  salaryMin             Int?
  salaryMax             Int?
  noticePeriod          String?  // e.g. "Immediate", "1 month"

  cvUrl                 String?
  source                String?  // job_application, talent_network, referral
  status                String?  // active, inactive

  applications          Application[]

  createdAt             DateTime @default(now())
  updatedAt             DateTime @updatedAt
}

model Application {
  id          String    @id @default(cuid())
  job         Job       @relation(fields: [jobId], references: [id])
  jobId       String
  candidate   Candidate @relation(fields: [candidateId], references: [id])
  candidateId String

  status      String    @default("applied") // applied, in_review, shortlisted, interview, offer, hired, rejected
  source      String?   // job_board, internal, referral
  notes       String?

  createdAt   DateTime  @default(now())
  updatedAt   DateTime  @updatedAt
}
